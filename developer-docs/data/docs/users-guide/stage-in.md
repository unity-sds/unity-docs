# Stage In

Data can be staged in / downloaded by using the latest DS image available at [https://github.com/unity-sds/unity-data-services/pkgs/container/unity-data-services](https://github.com/unity-sds/unity-data-services/pkgs/container/unity-data-services) and running the docker container with `DOWNLOAD` command

Environment variables used with `DOWNLOAD` command are described below.

| Name                        | Description                                                                                                                                                                                                                                                                                                         | Default Value                                                                                                                                                                                                                                                                              | Required                                                                                   |
| --------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------ |
| AWS\_ACCESS\_KEY\_ID        | AWS access key                                                                                                                                                                                                                                                                                                      |                                                                                                                                                                                                                                                                                            | No                                                                                         |
| AWS\_SECRET\_ACCESS\_KEY    | AWS secret key associated with the access key                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                                                                                            | No                                                                                         |
| AWS\_SESSION\_TOKEN         | AWS session token value required when using temporary security credentials                                                                                                                                                                                                                                          |                                                                                                                                                                                                                                                                                            | No                                                                                         |
| AWS\_REGION                 | AWS region                                                                                                                                                                                                                                                                                                          | us-west-2                                                                                                                                                                                                                                                                                  | No                                                                                         |
| USERNAME                    | Depending on `PASSWORD_TYPE`, MDPS username provided as either plain text, AWS Parameter Store key or Base64 encoded string                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                            | Yes, if `STAC_AUTH_TYPE` is UNITY                                                          |
| PASSWORD                    | Depending on `PASSWORD_TYPE`, MDPS password provided as either plain text, AWS Parameter Store key or Base64 encoded string                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                            | Yes, if `STAC_AUTH_TYPE` is UNITY                                                          |
| PASSWORD\_TYPE              | <p>Needs to be one of the following value</p><ul><li><code>PLAIN</code> - USERNAME and PASSWORD provided as plain text</li><li><code>PARAM_STORE</code> - USERNAME and PASSWORD provided as AWS Parameter Store key</li><li><code>BASE64</code> - USERNAME and PASSWORD provided as Base64 encoded string</li></ul> | PLAIN                                                                                                                                                                                                                                                                                      | Yes, if `STAC_AUTH_TYPE` is UNITY                                                          |
| CLIENT\_ID                  | AWS Cognito application client ID                                                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                            | Yes, if `STAC_AUTH_TYPE` is UNITY                                                          |
| COGNITO\_URL                | AWS Cognito Service Endpoint, e.g. https://cognito-idp.us-west-2.amazonaws.com                                                                                                                                                                                                                                      |                                                                                                                                                                                                                                                                                            | Yes, if `STAC_AUTH_TYPE` is UNITY                                                          |
| VERIFY\_SSL                 | Whether or not to check the validity of the SSL certificate presented by the server.                                                                                                                                                                                                                                | TRUE                                                                                                                                                                                                                                                                                       | No                                                                                         |
| STAC\_AUTH\_TYPE            | If `STAC_JSON` is URL and requires MDPS auth, then set to `UNITY`. If public URL, then set to `NONE`.                                                                                                                                                                                                               | NONE                                                                                                                                                                                                                                                                                       | Yes, if `STAC_JSON` is a Unity DAPA URL request                                            |
| STAC\_JSON                  | <p>Needs to be one of the following values</p><ul><li>Absolute path to a STAC file</li><li>STAC as a JSON string</li><li>https URL (either MDPS DAPA request or CMR request) to a STAC response</li></ul>                                                                                                           |                                                                                                                                                                                                                                                                                            | Yes                                                                                        |
| DOWNLOAD\_DIR               | Path to directory where files will be downloaded                                                                                                                                                                                                                                                                    |                                                                                                                                                                                                                                                                                            | Yes                                                                                        |
| DOWNLOADING\_KEYS           | Comma separated list of asset keys to download e.g. `data, metadata`. If not specified, will download all assets.                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                            | No                                                                                         |
| DOWNLOADING\_ROLES          | Comma separated list of asset roles to download e.g. `data, metadata`. If not specified, will download all assets.                                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                            | No                                                                                         |
| GRANULES\_DOWNLOAD\_TYPE    | <p>Can be one of the following values</p><ul><li><code>S3</code> - if downloading assets from MDPS AWS S3 venue buckets</li><li><code>DAAC</code> - if downloading assets from NASA DAACs Earthdata Cloud</li><li><code>HTTP</code> - if downloading assets publicly available through http protocol</li></ul>      | If not provided, will determine download type by examining assets href. If href starts with s3, assume download from MDPS AWS S3 venue buckets. If href starts with https and host contains earthdata.nasa.gov or earthdatacloud.nasa.gov, assume DAAC. Else assume public https download. | No                                                                                         |
| PARALLEL\_COUNT             | Number of threads used for downloading. Defaults to -1 which is equivalent to CPU count.                                                                                                                                                                                                                            | -1                                                                                                                                                                                                                                                                                         | No                                                                                         |
| DOWNLOAD\_RETRY\_WAIT\_TIME | Number of seconds to wait before retrying failed download                                                                                                                                                                                                                                                           | 30                                                                                                                                                                                                                                                                                         | No                                                                                         |
| DOWNLOAD\_RETRY\_TIMES      | Number of times to retry failed download                                                                                                                                                                                                                                                                            | 5                                                                                                                                                                                                                                                                                          | No                                                                                         |
| EDL\_USERNAME               | Depending on `EDL_PASSWORD_TYPE`, EDL username provided as either plain text, AWS Parameter Store key or Base64 encoded string                                                                                                                                                                                      |                                                                                                                                                                                                                                                                                            | Yes, if `STAC_JSON` points to assets distributed through NASA DAACs Earthdata Cloud        |
| EDL\_PASSWORD               | Depending on `EDL_PASSWORD_TYPE`, EDL password provided as either plain text, AWS Parameter Store key or Base64 encoded string                                                                                                                                                                                      |                                                                                                                                                                                                                                                                                            | Yes, if `STAC_JSON` points to assets distributed through NASA Earthdata Cloud (NASA DAACs) |
| EDL\_PASSWORD\_TYPE         | <p>Needs to be one of the following value</p><ul><li><code>PLAIN</code> - USERNAME and PASSWORD provided as plain text</li><li><code>PARAM_STORE</code> - USERNAME and PASSWORD provided as AWS Parameter Store key</li><li><code>BASE64</code> - USERNAME and PASSWORD provided as Base64 encoded string</li></ul> | PLAIN                                                                                                                                                                                                                                                                                      | Yes, if `STAC_JSON` points to assets distributed through NASA Earthdata Cloud (NASA DAACs) |
| EDL\_BASE\_URL              | NASA Earthdata Login URL                                                                                                                                                                                                                                                                                            | https://urs.earthdata.nasa.gov/                                                                                                                                                                                                                                                            | No                                                                                         |
| LOG\_LEVEL                  | <p><code>10</code> = DEBUG</p><p><code>20</code> = INFO</p><p><code>30</code> = WARNING</p><p><code>40</code> = ERROR</p><p><code>50</code> = CRITICAL</p>                                                                                                                                                          | 10                                                                                                                                                                                                                                                                                         | No                                                                                         |

